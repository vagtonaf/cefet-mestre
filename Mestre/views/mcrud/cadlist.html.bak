{{response.files.append(URL(r=request,c='static',f='jquery.dataTables.min.js'))}}
{{response.files.append(URL(r=request,c='static',f='demo_table.css'))}}
{{extend 'layout.html'}}
<script>
$(document).ready(function() { 
   jQuery('.smarttable').dataTable(); 
});
</script>
{{if ~form=='':}}
    <h1>Lista e Cadastra</h1>
    [<a href="#nil" onclick="jQuery('#form').slideToggle();">Cadastro</a>]

    {{if tabela=='aluno':}}
        {{=button('Lista Usuario','../mcrud/cadlist/auth_user')}}
        {{=button('Lista de Alocação','../mcrud/cadlist/alocacao')}}
    {{pass}}
    {{if tabela=='professor':}}
        {{=button('Lista Usuario','../mcrud/cadlist/auth_user')}}
        {{=button('Lista de Alocação','../mcrud/cadlist/alocacao')}}    
    {{pass}}
    {{if tabela=='alocacao':}}
        {{=button('Lista Plano de Prova','planoprova/list_planoprova')}}
        {{=button('Lista Aluno','../aluno/list_alunos')}}    
        {{=button('Lista Turma','../turma/list_turmas')}}
    {{pass}}
    <div id="form">
    <h2>Novo Registro de {{=tabela}}</h2>
        {{=form}}
    </div>
{{else:}}
    <h2>Solicitação não encontrada</h2>
{{pass}}
<br /><br />
{{flayout=0}}
{{if tabela=='aluno':}}
    {{flayout=1}}
    <table class="smarttable">
    <thead>
    <tr>
        <th>Matrícula</th><th>Nome</th><th>Email</th><th>Ação</th>
    </tr>    
    </thead>
    <tbody>
    {{for aluno in registros:}}
        <tr>
        <td>{{=A(aluno.aluno.matricula,_href=url('cadlist/aluno',aluno.aluno.id))}}</td>
        <td>{{=aluno.auth_user.first_name + ' ' + aluno.auth_user.last_name}}</td>
        <td>{{=aluno.auth_user.email}}</td>
        <td>{{=button('Alterar','edit/aluno',aluno.aluno.id)}}</td>
        </tr>
    {{pass}}
    </tbody>
    </table>
{{pass}}
{{if tabela=='professor':}}
    {{flayout=1}}
    <table class="smarttable">
    <thead>
    <tr>
       <th>Cod. func.</th><th>Nome</th><th>Email</th><th>Acao</th>
    </tr>    
    </thead>
    <tbody>
    {{for professor in registros:}}
        <tr>
        <td>{{=A(professor.professor.codigo_funcional,_href=url('cadlist/professor',professor.professor.id))}}</td>
        <td>{{=professor.auth_user.first_name + ' ' + professor.auth_user.last_name}}</td>
        <td>{{=professor.auth_user.email}}</td>
        <td>{{=button('Alterar','edit/professor',professor.professor.id)}}</td>
        </tr>
    {{pass}}
    </tbody>
    </table>
{{pass}}
{{if tabela=='alocacao':}}
    {{flayout=1}}
    <table border=1 class="smarttable">
    <thead>
    <tr><th colspan=4>[ Alocação ]</th></tr>
    <tr>
    <th>Nome</th><th>Matrícula</th><th>Turma</th><th>Data</th><th>Ação</th>
    </tr>    
    </thead>
    <tbody>
    {{for alocacao in registros:}}
        <tr>
        <td>{{=alocacao.alocacao.aluno.usuario.first_name + ' '+ alocacao.alocacao.aluno.usuario.last_name }}</td>
        <td>{{=alocacao.alocacao.aluno.matricula}}</td>
        <td>{{=alocacao.alocacao.turma.nome}}</td>
        <td>{{=alocacao.alocacao.data}}</td>
        <td>{{=button('Alterar','edit/alocacao',alocacao.alocacao.id)}}</td>
        </tr>
    {{pass}}
    </tbody>
    </table>
    <table border=1 class="smarttable">
    <thead>
    <tr><th colspan=4>[ Alunos ]</th></tr>
    <tr>
    <th>Nome</th><th>Matricula</th><th>Ação</th>
    </tr>    
    </thead>
    <tbody>
    {{for aluno in list_alunos:}}
        <tr>
        <td>{{=aluno.auth_user.first_name + ' '+ aluno.auth_user.last_name }}</td>
        <td>{{=aluno.aluno.matricula}}</td>
        <td>{{=button('Alterar','edit/aluno',aluno.aluno.id)}}</td>
        </tr>
    {{pass}}
    </tbody>
    </table>
    <table border=1 class="smarttable">
    <thead>
    <tr><th colspan=4>[ TURMAS ]</th></tr>
    <tr>
    <th>Disciplina</th><th>Nome</th><th>Ações</th>
    </tr>  
    </thead> 
    <tbody>    
    {{for turma in list_turmas:}}
        <tr>
        <td>{{=turma.disciplina.nome}}</td>
        <td>{{=turma.turma.nome}}</td>
        <td>{{=button('Alterar','edit/turma',turma.turma.id)}}</td>
        </tr>
   {{pass}}
</tbody>
</table>

{{if flayout==0:}}
    <table class="smarttable">
    <tbody>
    {{=registros}}
    </tbody>
    </table>
{{pass}}
